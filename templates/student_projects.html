{% extends 'base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/student_projects.css' %}?v=2">

<h2 class="page-title">Available Projects</h2>

{% for project in projects %}
<div class="project-card">

    <!-- üîπ HEADER -->
    <div class="project-header">
        <div>
            <h3>{{ project.title }}</h3>
            {% if project.short_description %}
                <p class="subtitle">{{ project.short_description }}</p>
            {% endif %}
        </div>

        <div class="meta-badges">
            <span class="badge status-{{ project.status }}">
                {{ project.get_status_display }}
            </span>

            {% if project.difficulty_level %}
                <span class="badge difficulty">
                    {{ project.get_difficulty_level_display }}
                </span>
            {% endif %}
        </div>
    </div>

    <!-- üìê DETAILS GRID -->
    <div class="project-details">

        <p>
            <strong>Domain</strong>
            {{ project.get_domain_display|default:"‚Äî" }}
        </p>

        <p>
            <strong>Technologies</strong>
            {{ project.technologies|default:"‚Äî" }}
        </p>

        <p>
            <strong>Start Date</strong>
            {{ project.start_date|default:"‚Äî" }}
        </p>

        <p>
            <strong>End Date</strong>
            {{ project.end_date|default:"‚Äî" }}
        </p>

        <p>
            <strong>Faculty Mentor</strong>
            {{ project.faculty.username }}
        </p>

        <p>
            <strong>Capacity</strong>
            {{ project.students.count }} / {{ project.max_students }}
        </p>

        {% if project.description %}
        <p class="full-width">
            <strong>Project Description</strong>
            {{ project.description }}
        </p>
        {% endif %}
    </div>

    <!-- üîó RESOURCES -->
    {% if project.github_link or project.documentation_link %}
    <div class="resources">
        {% if project.github_link %}
            <a href="{{ project.github_link }}" target="_blank">üíª GitHub</a>
        {% endif %}
        {% if project.documentation_link %}
            <a href="{{ project.documentation_link }}" target="_blank">üìÑ Docs</a>
        {% endif %}
    </div>
    {% endif %}

    <hr>

    <!-- ü§ù ACTIONS -->
    <div class="actions">
        {% if user in project.students.all %}
            <span class="status joined">‚úî Joined</span>

        {% elif project.students.count >= project.max_students %}
            <span class="status disabled">Project Full</span>

        {% elif project.status != 'open' %}
            <span class="status disabled">Not Open</span>

        {% else %}
            <form method="post" action="{% url 'join_project' project.id %}">
                {% csrf_token %}
                <button class="join-btn">ü§ù Join Project</button>
            </form>
        {% endif %}
    </div>

</div>
{% empty %}
<p class="empty">No projects available.</p>
{% endfor %}

{% endblock %}
